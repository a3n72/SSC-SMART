<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSC-SMART - æ™ºæ…§æé†’èˆ‡è­¦ç¤º Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        .header {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .header h1 {
            color: #2c3e50;
            font-size: 32px;
            margin-bottom: 10px;
        }
        .header .subtitle {
            color: #7f8c8d;
            font-size: 16px;
        }
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            position: relative;
            overflow: hidden;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: var(--card-color, #667eea);
        }
        .card.critical::before {
            background: #e74c3c;
        }
        .card.warning::before {
            background: #f39c12;
        }
        .card.info::before {
            background: #3498db;
        }
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        .card-title {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            flex: 1;
        }
        .card-indicator {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }
        .card-indicator.critical {
            background: #fee;
            color: #e74c3c;
        }
        .card-indicator.warning {
            background: #fff4e6;
            color: #f39c12;
        }
        .card-indicator.info {
            background: #e8f4f8;
            color: #3498db;
        }
        .card-detail {
            color: #555;
            line-height: 1.6;
            margin-bottom: 20px;
            font-size: 14px;
        }
        .card-source {
            font-size: 12px;
            color: #95a5a6;
            margin-bottom: 15px;
        }
        .card-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
        }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        .btn-secondary {
            background: #ecf0f1;
            color: #2c3e50;
        }
        .btn-secondary:hover {
            background: #d5dbdb;
        }
        .btn-success {
            background: #27ae60;
            color: white;
        }
        .btn-success:hover {
            background: #229954;
        }
        .suggestions {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #ecf0f1;
        }
        .suggestion-item {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .suggestion-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }
        .suggestion-label {
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        .suggestion-action {
            font-size: 12px;
            color: #7f8c8d;
        }
        .links {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #ecf0f1;
        }
        .link-item {
            display: inline-block;
            margin-right: 10px;
            margin-bottom: 10px;
            padding: 8px 15px;
            background: #f8f9fa;
            border-radius: 6px;
            text-decoration: none;
            color: #667eea;
            font-size: 13px;
            transition: all 0.3s;
        }
        .link-item:hover {
            background: #667eea;
            color: white;
        }
        .filter-bar {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
        }
        .filter-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .filter-group label {
            font-weight: 500;
            color: #2c3e50;
        }
        .filter-group select,
        .filter-group input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            text-align: center;
        }
        .stat-value {
            font-size: 36px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }
        .stat-label {
            color: #7f8c8d;
            font-size: 14px;
        }
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #95a5a6;
        }
        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }
        .refresh-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }
        .refresh-btn:hover {
            transform: rotate(180deg) scale(1.1);
        }
        .timestamp {
            font-size: 12px;
            color: #95a5a6;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”” æ™ºæ…§æé†’èˆ‡è­¦ç¤º Dashboard</h1>
            <div class="subtitle">SSC-SMART - åŸºæ–¼ HL7 FHIR CDS Hooks æ¨™æº–å¯¦ä½œ</div>
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-value" id="total-alerts">0</div>
                <div class="stat-label">ç¸½æé†’æ•¸</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="critical-alerts">0</div>
                <div class="stat-label">ç·Šæ€¥è­¦ç¤º</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="warning-alerts">0</div>
                <div class="stat-label">è­¦å‘Šæé†’</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="info-alerts">0</div>
                <div class="stat-label">ä¸€èˆ¬æé†’</div>
            </div>
        </div>

        <div class="filter-bar">
            <div class="filter-group">
                <label>è­¦ç¤ºç­‰ç´šï¼š</label>
                <select id="filter-indicator" onchange="filterCards()">
                    <option value="all">å…¨éƒ¨</option>
                    <option value="critical">ç·Šæ€¥</option>
                    <option value="warning">è­¦å‘Š</option>
                    <option value="info">ä¸€èˆ¬</option>
                </select>
            </div>
            <div class="filter-group">
                <label>æœå°‹ï¼š</label>
                <input type="text" id="search-input" placeholder="æœå°‹æé†’å…§å®¹..." oninput="filterCards()">
            </div>
            <div class="filter-group" style="margin-left: auto;">
                <button class="btn btn-primary" onclick="loadAlerts()">é‡æ–°è¼‰å…¥</button>
                <button class="btn btn-secondary" onclick="clearAllAlerts()">æ¸…é™¤å·²è®€</button>
            </div>
        </div>

        <div class="dashboard-grid" id="cards-container">
            <div class="empty-state">
                <div class="empty-state-icon">ğŸ“‹</div>
                <h3>è¼‰å…¥ä¸­...</h3>
                <p>æ­£åœ¨å¾ CDS Hooks æœå‹™è¼‰å…¥æé†’è³‡æ–™</p>
            </div>
        </div>
    </div>

    <button class="refresh-btn" onclick="loadAlerts()" title="é‡æ–°è¼‰å…¥">ğŸ”„</button>

    <script type="module">
        // CDS Hooks Dashboard ä¸»ç¨‹å¼
        let allCards = [];
        let filteredCards = [];

        // é å¯«çš„ç¤ºç¯„è³‡æ–™
        const predefinedAlerts = [
            {
                summary: 'è¡€å£“æ•¸å€¼ç•°å¸¸ï¼šæ•¸å€¼è¶…å‡ºæ­£å¸¸ç¯„åœ',
                detail: 'ç›®å‰æ•¸å€¼ï¼š165/95 mmHgï¼Œæ­£å¸¸ç¯„åœä¸Šé™ï¼š140/90 mmHgã€‚å€‹æ¡ˆè¡€å£“é€£çºŒå¤šæ—¥è¶…æ¨™ï¼Œå»ºè­°ç«‹å³è¿½è¹¤è™•ç†ã€‚',
                indicator: 'critical',
                source: { label: 'å¾¡ç®¡è½‰è¨ºå¹³å° - æ™ºæ…§æé†’èˆ‡è­¦ç¤º' },
                suggestions: [
                    {
                        label: 'æŸ¥çœ‹è©³ç´°è³‡æ–™',
                        uuid: 'alert-bp-001',
                        actions: [{
                            type: 'link',
                            description: 'å‰å¾€å€‹æ¡ˆç®¡ç†é é¢',
                            url: '/dashboard/patient/12345'
                        }]
                    },
                    {
                        label: 'ç™¼é€æé†’é€šçŸ¥',
                        uuid: 'notify-bp-001',
                        actions: [{
                            type: 'create',
                            description: 'å»ºç«‹æé†’é€šçŸ¥'
                        }]
                    }
                ],
                links: [
                    { label: 'æŸ¥çœ‹å®Œæ•´å¥åº·è¨˜éŒ„', url: '/dashboard/observations/12345', type: 'absolute' },
                    { label: 'è¯çµ¡å€‹ç®¡å¸«', url: '/dashboard/contact/12345', type: 'absolute' }
                ],
                timestamp: new Date().toISOString()
            },
            {
                summary: 'å®‰å¯§å…±ç…§ç¬¬äºŒæ¬¡è¨ªè¦–æé†’',
                detail: 'å€‹æ¡ˆæ–¼ 2026-01-16 å®Œæˆé¦–è¨ªï¼Œä»Šæ—¥ç‚ºç¬¬ä¸ƒæ—¥ï¼Œå»ºè­°é€²è¡Œç¬¬äºŒæ¬¡è¨ªè¦–ã€‚',
                indicator: 'info',
                source: { label: 'å¾¡ç®¡è½‰è¨ºå¹³å° - æ™ºæ…§æé†’èˆ‡è­¦ç¤º' },
                suggestions: [
                    {
                        label: 'å®‰æ’è¨ªè¦–',
                        uuid: 'schedule-visit-001',
                        actions: [{
                            type: 'create',
                            description: 'å»ºç«‹è¨ªè¦–é ç´„'
                        }]
                    }
                ],
                links: [
                    { label: 'æŸ¥çœ‹å€‹æ¡ˆè³‡æ–™', url: '/dashboard/patient/12345', type: 'absolute' }
                ],
                timestamp: new Date().toISOString()
            },
            {
                summary: 'æ˜æ—¥é–€è¨ºæé†’',
                detail: 'å€‹æ¡ˆé ç´„æ–¼æ˜æ—¥ 10:00 é€²è¡Œé–€è¨ºï¼Œè«‹æé†’å€‹æ¡ˆæº–æ™‚è¿”è¨ºã€‚',
                indicator: 'info',
                source: { label: 'å¾¡ç®¡è½‰è¨ºå¹³å° - æ™ºæ…§æé†’èˆ‡è­¦ç¤º' },
                suggestions: [
                    {
                        label: 'ç™¼é€æé†’è¨Šæ¯',
                        uuid: 'send-reminder-001',
                        actions: [{
                            type: 'create',
                            description: 'å»ºç«‹æé†’é€šçŸ¥'
                        }]
                    }
                ],
                links: [
                    { label: 'æŸ¥çœ‹é ç´„è©³æƒ…', url: '/dashboard/appointment/67890', type: 'absolute' }
                ],
                timestamp: new Date().toISOString()
            },
            {
                summary: 'æ—©æœŸ CKD å€‹æ¡ˆè½‰è¨ºæé†’',
                detail: 'æ­¤å€‹æ¡ˆç‚ºæ—©æœŸæ…¢æ€§è…è‡Ÿç—…ï¼ˆCKDï¼‰å€‹æ¡ˆï¼Œå»ºè­°è½‰è¨ºè‡³è…è‡Ÿç§‘é–€è¨ºé€²è¡Œå°ˆæ¥­è¿½è¹¤ã€‚',
                indicator: 'warning',
                source: { label: 'å¾¡ç®¡è½‰è¨ºå¹³å° - æ™ºæ…§æé†’èˆ‡è­¦ç¤º' },
                suggestions: [
                    {
                        label: 'å»ºç«‹è½‰è¨ºå–®',
                        uuid: 'referral-ckd-001',
                        actions: [{
                            type: 'create',
                            description: 'å»ºç«‹è½‰è¨ºå–®'
                        }]
                    }
                ],
                links: [
                    { label: 'æŸ¥çœ‹å€‹æ¡ˆå®Œæ•´è³‡æ–™', url: '/dashboard/patient/12345', type: 'absolute' },
                    { label: 'è…è‡Ÿç§‘é–€è¨ºè³‡è¨Š', url: '/dashboard/specialty/nephrology', type: 'absolute' }
                ],
                timestamp: new Date().toISOString()
            },
            {
                summary: 'è¡€ç³–æ•¸å€¼ç•°å¸¸ï¼šæ•¸å€¼è¶…å‡ºæ­£å¸¸ç¯„åœ',
                detail: 'ç›®å‰æ•¸å€¼ï¼š145 mg/dLï¼Œæ­£å¸¸ç¯„åœä¸Šé™ï¼š126 mg/dLã€‚å»ºè­°è¿½è¹¤è™•ç†ã€‚',
                indicator: 'warning',
                source: { label: 'å¾¡ç®¡è½‰è¨ºå¹³å° - æ™ºæ…§æé†’èˆ‡è­¦ç¤º' },
                suggestions: [
                    {
                        label: 'æŸ¥çœ‹è©³ç´°è³‡æ–™',
                        uuid: 'alert-glucose-001',
                        actions: [{
                            type: 'link',
                            description: 'å‰å¾€å€‹æ¡ˆç®¡ç†é é¢',
                            url: '/dashboard/patient/12345'
                        }]
                    }
                ],
                links: [
                    { label: 'æŸ¥çœ‹å®Œæ•´å¥åº·è¨˜éŒ„', url: '/dashboard/observations/12345', type: 'absolute' }
                ],
                timestamp: new Date().toISOString()
            },
            {
                summary: 'æˆ’è¸é–€è¨ºæé†’',
                detail: 'æ­¤å€‹æ¡ˆç›®å‰æœ‰æŠ½è¸ç¿’æ…£ï¼Œå»ºè­°æä¾›æˆ’è¸é–€è¨ºè³‡è¨Šä¸¦è¿½è¹¤å°±é†«æƒ…æ³ã€‚',
                indicator: 'info',
                source: { label: 'å¾¡ç®¡è½‰è¨ºå¹³å° - æ™ºæ…§æé†’èˆ‡è­¦ç¤º' },
                suggestions: [
                    {
                        label: 'ç™¼é€æˆ’è¸è³‡è¨Š',
                        uuid: 'smoking-info-001',
                        actions: [{
                            type: 'create',
                            description: 'å»ºç«‹è¡›æ•™è³‡æ–™'
                        }]
                    }
                ],
                links: [
                    { label: 'æˆ’è¸é–€è¨ºæŸ¥è©¢', url: '/dashboard/smoking-cessation', type: 'absolute' }
                ],
                timestamp: new Date().toISOString()
            }
        ];

        // è¼‰å…¥æé†’è³‡æ–™
        window.loadAlerts = async function() {
            const container = document.getElementById('cards-container');
            container.innerHTML = '<div class="empty-state"><div class="empty-state-icon">â³</div><h3>è¼‰å…¥ä¸­...</h3></div>';

            try {
                // å˜—è©¦å¾ CDS Hooks æœå‹™è¼‰å…¥ï¼ˆå¦‚æœæœ‰çš„è©±ï¼‰
                const cdsHooksUrl = localStorage.getItem('cds-hooks-url') || 'http://localhost:3000/cds-services/patient-view';
                
                // é€™è£¡å¯ä»¥å¯¦éš›å‘¼å« CDS Hooks æœå‹™
                // const response = await fetch(cdsHooksUrl, {
                //     method: 'POST',
                //     headers: { 'Content-Type': 'application/json' },
                //     body: JSON.stringify({
                //         hook: 'patient-view',
                //         hookInstance: 'unique-instance-id',
                //         context: {
                //             patientId: '12345',
                //             userId: 'user-001'
                //         },
                //         prefetch: {}
                //     })
                // });
                // const data = await response.json();
                // allCards = data.cards || [];

                // ç›®å‰ä½¿ç”¨é å¯«è³‡æ–™ä½œç‚ºç¤ºç¯„
                allCards = predefinedAlerts;
                
                filteredCards = [...allCards];
                renderCards();
                updateStats();
            } catch (error) {
                console.error('è¼‰å…¥æé†’å¤±æ•—:', error);
                // å¦‚æœæœå‹™ä¸å¯ç”¨ï¼Œä½¿ç”¨é å¯«è³‡æ–™
                allCards = predefinedAlerts;
                filteredCards = [...allCards];
                renderCards();
                updateStats();
            }
        };

        // æ¸²æŸ“å¡ç‰‡
        function renderCards() {
            const container = document.getElementById('cards-container');
            
            if (filteredCards.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">âœ…</div>
                        <h3>ç›®å‰æ²’æœ‰æé†’</h3>
                        <p>æ‰€æœ‰æé†’éƒ½å·²è™•ç†å®Œç•¢</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredCards.map((card, index) => {
                const indicatorClass = card.indicator || 'info';
                const timestamp = card.timestamp ? new Date(card.timestamp).toLocaleString('zh-TW') : '';
                
                let suggestionsHTML = '';
                if (card.suggestions && card.suggestions.length > 0) {
                    suggestionsHTML = `
                        <div class="suggestions">
                            <strong style="font-size: 12px; color: #7f8c8d; text-transform: uppercase;">å»ºè­°å‹•ä½œï¼š</strong>
                            ${card.suggestions.map(suggestion => `
                                <div class="suggestion-item" onclick="handleSuggestion('${suggestion.uuid}', ${index})">
                                    <div class="suggestion-label">${suggestion.label}</div>
                                    ${suggestion.actions && suggestion.actions.length > 0 ? 
                                        `<div class="suggestion-action">${suggestion.actions[0].description || ''}</div>` : ''}
                                </div>
                            `).join('')}
                        </div>
                    `;
                }

                let linksHTML = '';
                if (card.links && card.links.length > 0) {
                    linksHTML = `
                        <div class="links">
                            ${card.links.map(link => `
                                <a href="${link.url}" class="link-item" target="_blank">${link.label}</a>
                            `).join('')}
                        </div>
                    `;
                }

                return `
                    <div class="card ${indicatorClass}" data-index="${index}">
                        <div class="card-header">
                            <div class="card-title">${card.summary}</div>
                            <span class="card-indicator ${indicatorClass}">${getIndicatorText(indicatorClass)}</span>
                        </div>
                        <div class="card-detail">${card.detail}</div>
                        <div class="card-source">ä¾†æºï¼š${card.source?.label || 'æœªçŸ¥'}</div>
                        ${suggestionsHTML}
                        ${linksHTML}
                        ${timestamp ? `<div class="timestamp">å»ºç«‹æ™‚é–“ï¼š${timestamp}</div>` : ''}
                        <div class="card-actions">
                            <button class="btn btn-primary" onclick="handleCardAction('view', ${index})">æŸ¥çœ‹è©³æƒ…</button>
                            <button class="btn btn-success" onclick="handleCardAction('resolve', ${index})">æ¨™è¨˜å·²è™•ç†</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // å–å¾—è­¦ç¤ºç­‰ç´šæ–‡å­—
        function getIndicatorText(indicator) {
            const map = {
                'critical': 'ç·Šæ€¥',
                'warning': 'è­¦å‘Š',
                'info': 'ä¸€èˆ¬'
            };
            return map[indicator] || indicator;
        }

        // è™•ç†å»ºè­°å‹•ä½œ
        window.handleSuggestion = function(uuid, cardIndex) {
            const card = filteredCards[cardIndex];
            const suggestion = card.suggestions?.find(s => s.uuid === uuid);
            
            if (suggestion) {
                console.log('åŸ·è¡Œå»ºè­°å‹•ä½œ:', suggestion);
                alert(`åŸ·è¡Œå‹•ä½œï¼š${suggestion.label}\n\né€™æ˜¯ä¸€å€‹ç¤ºç¯„ï¼Œå¯¦éš›ç’°å¢ƒä¸­æœƒåŸ·è¡Œå°æ‡‰çš„ FHIR è³‡æºæ“ä½œã€‚`);
                
                // å¯¦éš›ç’°å¢ƒä¸­å¯ä»¥åŸ·è¡Œå°æ‡‰çš„å‹•ä½œ
                if (suggestion.actions && suggestion.actions.length > 0) {
                    const action = suggestion.actions[0];
                    if (action.type === 'create' && action.resource) {
                        // å»ºç«‹ FHIR è³‡æº
                        console.log('å»ºç«‹è³‡æº:', action.resource);
                    } else if (action.type === 'link' && action.url) {
                        // å°å‘é€£çµ
                        window.open(action.url, '_blank');
                    }
                }
            }
        };

        // è™•ç†å¡ç‰‡å‹•ä½œ
        window.handleCardAction = function(action, cardIndex) {
            if (action === 'view') {
                const card = filteredCards[cardIndex];
                console.log('æŸ¥çœ‹å¡ç‰‡è©³æƒ…:', card);
                alert(`æŸ¥çœ‹è©³æƒ…ï¼š${card.summary}\n\n${card.detail}`);
            } else if (action === 'resolve') {
                // ç§»é™¤å·²è™•ç†çš„å¡ç‰‡
                const card = filteredCards[cardIndex];
                filteredCards = filteredCards.filter((_, i) => i !== cardIndex);
                allCards = allCards.filter(c => c !== card);
                renderCards();
                updateStats();
                console.log('å·²æ¨™è¨˜ç‚ºè™•ç†:', card.summary);
            }
        };

        // éæ¿¾å¡ç‰‡
        window.filterCards = function() {
            const indicatorFilter = document.getElementById('filter-indicator').value;
            const searchText = document.getElementById('search-input').value.toLowerCase();

            filteredCards = allCards.filter(card => {
                const matchIndicator = indicatorFilter === 'all' || card.indicator === indicatorFilter;
                const matchSearch = !searchText || 
                    card.summary.toLowerCase().includes(searchText) ||
                    card.detail.toLowerCase().includes(searchText);
                return matchIndicator && matchSearch;
            });

            renderCards();
            updateStats();
        };

        // æ›´æ–°çµ±è¨ˆ
        function updateStats() {
            document.getElementById('total-alerts').textContent = allCards.length;
            document.getElementById('critical-alerts').textContent = 
                allCards.filter(c => c.indicator === 'critical').length;
            document.getElementById('warning-alerts').textContent = 
                allCards.filter(c => c.indicator === 'warning').length;
            document.getElementById('info-alerts').textContent = 
                allCards.filter(c => c.indicator === 'info').length;
        }

        // æ¸…é™¤å·²è®€æé†’
        window.clearAllAlerts = function() {
            if (confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰æé†’å—ï¼Ÿ')) {
                allCards = [];
                filteredCards = [];
                renderCards();
                updateStats();
            }
        };

        // åˆå§‹åŒ–è¼‰å…¥
        loadAlerts();

        // å®šæœŸè‡ªå‹•é‡æ–°è¼‰å…¥ï¼ˆæ¯ 5 åˆ†é˜ï¼‰
        setInterval(loadAlerts, 5 * 60 * 1000);
    </script>
</body>
</html>
